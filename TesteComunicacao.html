<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
  <h2>ğŸ”§ Teste de ComunicaÃ§Ã£o</h2>
  <button onclick="testar()">Testar ConexÃ£o</button>
  <button onclick="testarPendentes()">Buscar Pendentes</button>
  <pre id="resultado" style="background:#f1f5f9; padding:16px; border-radius:8px; margin-top:16px;"></pre>

  <script>
    function log(msg) {
      document.getElementById('resultado').innerText += msg + '\n';
    }

    function testar() {
      log('ğŸ”„ Chamando testarConexao()...');
      google.script.run
        .withSuccessHandler(function(res) {
          log('âœ… Sucesso: ' + JSON.stringify(res, null, 2));
        })
        .withFailureHandler(function(err) {
          log('âŒ Erro: ' + err.message);
        })
        .testarConexao();
    }

    function testarPendentes() {
      log('ğŸ”„ Chamando getOrdensPendentes()...');
      google.script.run
        .withSuccessHandler(function(dados) {
          if (dados && dados.erro) {
            log('âŒ Erro retornado pelo backend: ' + dados.mensagem);
            if (dados.stack) log('Stack: ' + dados.stack);
          } else {
            log('âœ… Sucesso! Retornou ' + dados.length + ' registros.');
            log('Primeiro registro: ' + JSON.stringify(dados[0], null, 2));
          }
        })
        .withFailureHandler(function(err) {
          log('âŒ Falha na comunicaÃ§Ã£o: ' + err.message);
        })
        .getOrdensPendentes();
    }
  </script>
</body>
</html>